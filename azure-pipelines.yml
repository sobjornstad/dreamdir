# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- master

pool:
  vmImage: ubuntu-16.04

steps:
- bash: |
    make
  displayName: 'Build drwc to check for errors'
  workingDirectory: $(Build.SourcesDirectory)/drwc

- bash: |
    export PATH="$PATH:."
    export DEBIAN_FRONTEND=noninteractive # make apt-get shut up
    sudo apt-get install bats
    tests/test_dr
  displayName: 'Run bats tests'

- bash: |
    export DEBIAN_FRONTEND=noninteractive
    sudo apt-get install shellcheck
    shellcheck dr
  displayName: 'Run shellcheck'